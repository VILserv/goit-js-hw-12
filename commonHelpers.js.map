{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { Spinner } from 'spin.js';\n\nconst API_KEY = '41838094-2685b6b1a22c51550e2439076';\nconst searchFormEl = document.querySelector('.search-form');\nconst galleryContainer = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst spinnerContainer = document.querySelector('.js-loader');\nconst opts = {\n  lines: 12, // The number of lines to draw\n  length: 11, // The length of each line\n  width: 10, // The line thickness\n  radius: 34, // The radius of the inner circle\n  scale: 1.45, // Scales overall size of the spinner\n  corners: 1, // Corner roundness (0..1)\n  speed: 0.9, // Rounds per second\n  rotate: 24, // The rotation offset\n  animation: 'spinner-line-shrink', // The CSS animation name for the lines\n  direction: 1, // 1: clockwise, -1: counterclockwise\n  color: '#ffffff', // CSS color or array of colors\n  fadeColor: 'transparent', // CSS color or array of colors\n  top: '50%', // Top position relative to parent\n  left: '50%', // Left position relative to parent\n  shadow: '0 0 1px transparent', // Box-shadow for the lines\n  zIndex: 2000000000, // The z-index (defaults to 2e9)\n  className: 'spinner', // The CSS class to assign to the spinner\n  position: 'absolute', // Element positioning\n};\nconst spinner = new Spinner(opts);\nspinner.spin(spinnerContainer);\n\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nlet imagesLoaded = 0;\n\nloaderEl.style.display = 'none';\nloadMoreBtn.classList.remove('visible');\n\nsearchFormEl.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', loadMore);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    iziToast.warning({\n      title: 'Warning!',\n      message: 'Please enter image name!',\n      position: 'topRight',\n      color: '#FFA000',\n    });\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n  hideLoadMoreBtn();\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 40,\n      },\n    });\n\n    hideLoader();\n\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        color: '#EF4040',\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    imagesLoaded = data.hits.length;\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    iziToast.info({\n      message: `Congrats! We found ${totalHits} images.`,\n      position: 'topRight',\n      color: '#59A10D',\n    });\n\n    if (totalHits > 40) {\n      showLoadMoreBtn();\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch images. Please try again later.',\n      position: 'topRight',\n      color: '#EF4040',\n    });\n  }\n}\n\nfunction renderImages(images) {\n  const fragment = document.createDocumentFragment();\n\n  images.forEach(image => {\n    const imageCardEl = createImageCard(image);\n    fragment.appendChild(imageCardEl);\n  });\n\n  galleryContainer.appendChild(fragment);\n}\n\nfunction createImageCard(image) {\n  const imageCardEl = document.createElement('div');\n  imageCardEl.classList.add('card');\n\n  imageCardEl.innerHTML = `\n    <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n      <img class=\"card-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n    </a>\n    <div class=\"card-info\">\n      <p class=\"card-text\"><b>Likes:</b> ${image.likes}</p>\n      <p class=\"card-text\"><b>Views:</b> ${image.views}</p>\n      <p class=\"card-text\"><b>Comments:</b> ${image.comments}</p>\n      <p class=\"card-text\"><b>Downloads:</b> ${image.downloads}</p>\n    </div>\n  `;\n\n  return imageCardEl;\n}\n\nfunction clearGallery() {\n  galleryContainer.innerHTML = '';\n  currentPage = 1;\n  hideLoadMoreBtn();\n}\ncurrentPage++;\n\nasync function loadMore() {\n  showLoader();\n  hideLoadMoreBtn();\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 40,\n      },\n    });\n\n    hideLoader();\n\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      return;\n    }\n\n    if (imagesLoaded + data.hits.length > totalHits) {\n      data.hits = data.hits.slice(0, totalHits - imagesLoaded);\n    }\n\n    imagesLoaded += data.hits.length;\n\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    if (imagesLoaded >= totalHits) {\n      hideLoadMoreBtn();\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n        color: '#EF4040',\n      });\n    } else {\n      showLoadMoreBtn();\n    }\n\n    const cards = document.querySelectorAll('.card');\n    const newImages = Array.from(cards).slice(-40);\n    if (newImages.length > 0) {\n      const firstNewImage = newImages[0];\n\n      firstNewImage.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching more images:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Failed to fetch more images. Please try again later.',\n      position: 'topRight',\n      color: '#EF4040',\n    });\n  }\n}\n\nfunction showLoader() {\n  loaderEl.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loaderEl.style.display = 'none';\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n"],"names":["API_KEY","searchFormEl","galleryContainer","lightbox","SimpleLightbox","spinnerContainer","opts","spinner","Spinner","loaderEl","loadMoreBtn","currentPage","totalHits","searchQuery","imagesLoaded","handleFormSubmit","loadMore","event","iziToast","clearGallery","showLoader","hideLoadMoreBtn","response","axios","hideLoader","data","renderImages","showLoadMoreBtn","error","images","fragment","image","imageCardEl","createImageCard","cards","newImages"],"mappings":"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"}